{"version":3,"file":"hierarchy-chart.min.js","sources":["../../../apps/erpnext/erpnext/public/js/hierarchy_chart/hierarchy_chart_desktop.js","../../../apps/erpnext/erpnext/public/js/hierarchy_chart/hierarchy_chart_mobile.js"],"sourcesContent":["import html2canvas from 'html2canvas';\nerpnext.HierarchyChart = class {\n\t/* Options:\n\t\t- doctype\n\t\t- wrapper: wrapper for the hierarchy view\n\t\t- method:\n\t\t\t- to get the data for each node\n\t\t\t- this method should return id, name, title, image, and connections for each node\n\t*/\n\tconstructor(doctype, wrapper, method) {\n\t\tthis.page = wrapper.page;\n\t\tthis.method = method;\n\t\tthis.doctype = doctype;\n\n\t\tthis.setup_page_style();\n\t\tthis.page.main.addClass('frappe-card');\n\n\t\tthis.nodes = {};\n\t\tthis.setup_node_class();\n\t}\n\n\tsetup_page_style() {\n\t\tthis.page.main.css({\n\t\t\t'min-height': '300px',\n\t\t\t'max-height': '600px',\n\t\t\t'overflow': 'auto',\n\t\t\t'position': 'relative'\n\t\t});\n\t}\n\n\tsetup_node_class() {\n\t\tlet me = this;\n\t\tthis.Node = class {\n\t\t\tconstructor({\n\t\t\t\tid, parent, parent_id, image, name, title, expandable, connections, is_root // eslint-disable-line\n\t\t\t}) {\n\t\t\t\t// to setup values passed via constructor\n\t\t\t\t$.extend(this, arguments[0]);\n\n\t\t\t\tthis.expanded = 0;\n\n\t\t\t\tme.nodes[this.id] = this;\n\t\t\t\tme.make_node_element(this);\n\n\t\t\t\tif (!me.all_nodes_expanded) {\n\t\t\t\t\tme.setup_node_click_action(this);\n\t\t\t\t}\n\n\t\t\t\tme.setup_edit_node_action(this);\n\t\t\t}\n\t\t};\n\t}\n\n\tmake_node_element(node) {\n\t\tlet node_card = frappe.render_template('node_card', {\n\t\t\tid: node.id,\n\t\t\tname: node.name,\n\t\t\ttitle: node.title,\n\t\t\timage: node.image,\n\t\t\tparent: node.parent_id,\n\t\t\tconnections: node.connections,\n\t\t\tis_mobile: false\n\t\t});\n\n\t\tnode.parent.append(node_card);\n\t\tnode.$link = $(`[id=\"${node.id}\"]`);\n\t}\n\n\tshow() {\n\t\tthis.setup_actions();\n\t\tif ($(`[data-fieldname=\"company\"]`).length) return;\n\t\tlet me = this;\n\n\t\tlet company = this.page.add_field({\n\t\t\tfieldtype: 'Link',\n\t\t\toptions: 'Company',\n\t\t\tfieldname: 'company',\n\t\t\tplaceholder: __('Select Company'),\n\t\t\tdefault: frappe.defaults.get_default('company'),\n\t\t\tonly_select: true,\n\t\t\treqd: 1,\n\t\t\tchange: () => {\n\t\t\t\tme.company = undefined;\n\t\t\t\t$('#hierarchy-chart-wrapper').remove();\n\n\t\t\t\tif (company.get_value()) {\n\t\t\t\t\tme.company = company.get_value();\n\n\t\t\t\t\t// svg for connectors\n\t\t\t\t\tme.make_svg_markers();\n\t\t\t\t\tme.setup_hierarchy();\n\t\t\t\t\tme.render_root_nodes();\n\t\t\t\t\tme.all_nodes_expanded = false;\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.throw(__('Please select a company first.'));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tcompany.refresh();\n\t\t$(`[data-fieldname=\"company\"]`).trigger('change');\n\t\t$(`[data-fieldname=\"company\"] .link-field`).css('z-index', 2);\n\t}\n\n\tsetup_actions() {\n\t\tlet me = this;\n\t\tthis.page.clear_inner_toolbar();\n\t\tthis.page.add_inner_button(__('Export'), function() {\n\t\t\tme.export_chart();\n\t\t});\n\n\t\tthis.page.add_inner_button(__('Expand All'), function() {\n\t\t\tme.load_children(me.root_node, true);\n\t\t\tme.all_nodes_expanded = true;\n\n\t\t\tme.page.remove_inner_button(__('Expand All'));\n\t\t\tme.page.add_inner_button(__('Collapse All'), function() {\n\t\t\t\tme.setup_hierarchy();\n\t\t\t\tme.render_root_nodes();\n\t\t\t\tme.all_nodes_expanded = false;\n\n\t\t\t\tme.page.remove_inner_button(__('Collapse All'));\n\t\t\t\tme.setup_actions();\n\t\t\t});\n\t\t});\n\t}\n\n\texport_chart() {\n\t\tfrappe.dom.freeze(__('Exporting...'));\n\t\tthis.page.main.css({\n\t\t\t'min-height': '',\n\t\t\t'max-height': '',\n\t\t\t'overflow': 'visible',\n\t\t\t'position': 'fixed',\n\t\t\t'left': '0',\n\t\t\t'top': '0'\n\t\t});\n\n\t\t$('.node-card').addClass('exported');\n\n\t\thtml2canvas(document.querySelector('#hierarchy-chart-wrapper'), {\n\t\t\tscrollY: -window.scrollY,\n\t\t\tscrollX: 0\n\t\t}).then(function(canvas) {\n\t\t\t// Export the canvas to its data URI representation\n\t\t\tlet dataURL = canvas.toDataURL('image/png');\n\n\t\t\t// download the image\n\t\t\tlet a = document.createElement('a');\n\t\t\ta.href = dataURL;\n\t\t\ta.download = 'hierarchy_chart';\n\t\t\ta.click();\n\t\t}).finally(() => {\n\t\t\tfrappe.dom.unfreeze();\n\t\t});\n\n\t\tthis.setup_page_style();\n\t\t$('.node-card').removeClass('exported');\n\t}\n\n\tsetup_hierarchy() {\n\t\tif (this.$hierarchy)\n\t\t\tthis.$hierarchy.remove();\n\n\t\t$(`#connectors`).empty();\n\n\t\t// setup hierarchy\n\t\tthis.$hierarchy = $(\n\t\t\t`<ul class=\"hierarchy\">\n\t\t\t\t<li class=\"root-level level\">\n\t\t\t\t\t<ul class=\"node-children\"></ul>\n\t\t\t\t</li>\n\t\t\t</ul>`);\n\n\t\tthis.page.main\n\t\t\t.find('#hierarchy-chart')\n\t\t\t.empty()\n\t\t\t.append(this.$hierarchy);\n\n\t\tthis.nodes = {};\n\t}\n\n\tmake_svg_markers() {\n\t\t$('#hierarchy-chart-wrapper').remove();\n\n\t\tthis.page.main.append(`\n\t\t\t<div id=\"hierarchy-chart-wrapper\">\n\t\t\t\t<svg id=\"arrows\" width=\"100%\" height=\"100%\">\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<marker id=\"arrowhead-active\" viewBox=\"0 0 10 10\" refX=\"3\" refY=\"5\" markerWidth=\"6\" markerHeight=\"6\" orient=\"auto\" fill=\"var(--blue-500)\">\n\t\t\t\t\t\t\t<path d=\"M 0 0 L 10 5 L 0 10 z\"></path>\n\t\t\t\t\t\t</marker>\n\t\t\t\t\t\t<marker id=\"arrowhead-collapsed\" viewBox=\"0 0 10 10\" refX=\"3\" refY=\"5\" markerWidth=\"6\" markerHeight=\"6\" orient=\"auto\" fill=\"var(--blue-300)\">\n\t\t\t\t\t\t\t<path d=\"M 0 0 L 10 5 L 0 10 z\"></path>\n\t\t\t\t\t\t</marker>\n\n\t\t\t\t\t\t<marker id=\"arrowstart-active\" viewBox=\"0 0 10 10\" refX=\"3\" refY=\"5\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\" fill=\"var(--blue-500)\">\n\t\t\t\t\t\t\t<circle cx=\"4\" cy=\"4\" r=\"3.5\" fill=\"white\" stroke=\"var(--blue-500)\"/>\n\t\t\t\t\t\t</marker>\n\t\t\t\t\t\t<marker id=\"arrowstart-collapsed\" viewBox=\"0 0 10 10\" refX=\"3\" refY=\"5\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\" fill=\"var(--blue-300)\">\n\t\t\t\t\t\t\t<circle cx=\"4\" cy=\"4\" r=\"3.5\" fill=\"white\" stroke=\"var(--blue-300)\"/>\n\t\t\t\t\t\t</marker>\n\t\t\t\t\t</defs>\n\t\t\t\t\t<g id=\"connectors\" fill=\"none\">\n\t\t\t\t\t</g>\n\t\t\t\t</svg>\n\t\t\t\t<div id=\"hierarchy-chart\">\n\t\t\t\t</div>\n\t\t\t</div>`);\n\t}\n\n\trender_root_nodes(expanded_view=false) {\n\t\tlet me = this;\n\n\t\treturn frappe.call({\n\t\t\tmethod: me.method,\n\t\t\targs: {\n\t\t\t\tcompany: me.company\n\t\t\t}\n\t\t}).then(r => {\n\t\t\tif (r.message.length) {\n\t\t\t\tlet expand_node = undefined;\n\t\t\t\tlet node = undefined;\n\n\t\t\t\t$.each(r.message, (_i, data) => {\n\t\t\t\t\tif ($(`[id=\"${data.id}\"]`).length)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tnode = new me.Node({\n\t\t\t\t\t\tid: data.id,\n\t\t\t\t\t\tparent: $('<li class=\"child-node\"></li>').appendTo(me.$hierarchy.find('.node-children')),\n\t\t\t\t\t\tparent_id: undefined,\n\t\t\t\t\t\timage: data.image,\n\t\t\t\t\t\tname: data.name,\n\t\t\t\t\t\ttitle: data.title,\n\t\t\t\t\t\texpandable: true,\n\t\t\t\t\t\tconnections: data.connections,\n\t\t\t\t\t\tis_root: true\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!expand_node && data.connections)\n\t\t\t\t\t\texpand_node = node;\n\t\t\t\t});\n\n\t\t\t\tme.root_node = expand_node;\n\t\t\t\tif (!expanded_view) {\n\t\t\t\t\tme.expand_node(expand_node);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\texpand_node(node) {\n\t\tconst is_sibling = this.selected_node && this.selected_node.parent_id === node.parent_id;\n\t\tthis.set_selected_node(node);\n\t\tthis.show_active_path(node);\n\t\tthis.collapse_previous_level_nodes(node);\n\n\t\t// since the previous node collapses, all connections to that node need to be rebuilt\n\t\t// if a sibling node is clicked, connections don't need to be rebuilt\n\t\tif (!is_sibling) {\n\t\t\t// rebuild outgoing connections\n\t\t\tthis.refresh_connectors(node.parent_id);\n\n\t\t\t// rebuild incoming connections\n\t\t\tlet grandparent = $(`[id=\"${node.parent_id}\"]`).attr('data-parent');\n\t\t\tthis.refresh_connectors(grandparent);\n\t\t}\n\n\t\tif (node.expandable && !node.expanded) {\n\t\t\treturn this.load_children(node);\n\t\t}\n\t}\n\n\tcollapse_node() {\n\t\tif (this.selected_node.expandable) {\n\t\t\tthis.selected_node.$children.hide();\n\t\t\t$(`path[data-parent=\"${this.selected_node.id}\"]`).hide();\n\t\t\tthis.selected_node.expanded = false;\n\t\t}\n\t}\n\n\tshow_active_path(node) {\n\t\t// mark node parent on active path\n\t\t$(`[id=\"${node.parent_id}\"]`).addClass('active-path');\n\t}\n\n\tload_children(node, deep=false) {\n\t\tif (!deep) {\n\t\t\tfrappe.run_serially([\n\t\t\t\t() => this.get_child_nodes(node.id),\n\t\t\t\t(child_nodes) => this.render_child_nodes(node, child_nodes)\n\t\t\t]);\n\t\t} else {\n\t\t\tfrappe.run_serially([\n\t\t\t\t() => frappe.dom.freeze(),\n\t\t\t\t() => this.setup_hierarchy(),\n\t\t\t\t() => this.render_root_nodes(true),\n\t\t\t\t() => this.get_all_nodes(),\n\t\t\t\t(data_list) => this.render_children_of_all_nodes(data_list),\n\t\t\t\t() => frappe.dom.unfreeze()\n\t\t\t]);\n\t\t}\n\t}\n\n\tget_child_nodes(node_id) {\n\t\tlet me = this;\n\t\treturn new Promise(resolve => {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: me.method,\n\t\t\t\targs: {\n\t\t\t\t\tparent: node_id,\n\t\t\t\t\tcompany: me.company\n\t\t\t\t}\n\t\t\t}).then(r => resolve(r.message));\n\t\t});\n\t}\n\n\trender_child_nodes(node, child_nodes) {\n\t\tconst last_level = this.$hierarchy.find('.level:last').index();\n\t\tconst current_level = $(`[id=\"${node.id}\"]`).parent().parent().parent().index();\n\n\t\tif (last_level === current_level) {\n\t\t\tthis.$hierarchy.append(`\n\t\t\t\t<li class=\"level\"></li>\n\t\t\t`);\n\t\t}\n\n\t\tif (!node.$children) {\n\t\t\tnode.$children = $('<ul class=\"node-children\"></ul>')\n\t\t\t\t.hide()\n\t\t\t\t.appendTo(this.$hierarchy.find('.level:last'));\n\n\t\t\tnode.$children.empty();\n\n\t\t\tif (child_nodes) {\n\t\t\t\t$.each(child_nodes, (_i, data) => {\n\t\t\t\t\tif (!$(`[id=\"${data.id}\"]`).length) {\n\t\t\t\t\t\tthis.add_node(node, data);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.add_connector(node.id, data.id);\n\t\t\t\t\t\t}, 250);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tnode.$children.show();\n\t\t$(`path[data-parent=\"${node.id}\"]`).show();\n\t\tnode.expanded = true;\n\t}\n\n\tget_all_nodes() {\n\t\tlet me = this;\n\t\treturn new Promise(resolve => {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: 'erpnext.utilities.hierarchy_chart.get_all_nodes',\n\t\t\t\targs: {\n\t\t\t\t\tmethod: me.method,\n\t\t\t\t\tcompany: me.company\n\t\t\t\t},\n\t\t\t\tcallback: (r) => {\n\t\t\t\t\tresolve(r.message);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\trender_children_of_all_nodes(data_list) {\n\t\tlet entry = undefined;\n\t\tlet node = undefined;\n\n\t\twhile (data_list.length) {\n\t\t\t// to avoid overlapping connectors\n\t\t\tentry = data_list.shift();\n\t\t\tnode = this.nodes[entry.parent];\n\t\t\tif (node) {\n\t\t\t\tthis.render_child_nodes_for_expanded_view(node, entry.data);\n\t\t\t} else if (data_list.length) {\n\t\t\t\tdata_list.push(entry);\n\t\t\t}\n\t\t}\n\t}\n\n\trender_child_nodes_for_expanded_view(node, child_nodes) {\n\t\tnode.$children = $('<ul class=\"node-children\"></ul>');\n\n\t\tconst last_level = this.$hierarchy.find('.level:last').index();\n\t\tconst node_level = $(`[id=\"${node.id}\"]`).parent().parent().parent().index();\n\n\t\tif (last_level === node_level) {\n\t\t\tthis.$hierarchy.append(`\n\t\t\t\t<li class=\"level\"></li>\n\t\t\t`);\n\t\t\tnode.$children.appendTo(this.$hierarchy.find('.level:last'));\n\t\t} else {\n\t\t\tnode.$children.appendTo(this.$hierarchy.find('.level:eq(' + (node_level + 1) + ')'));\n\t\t}\n\n\t\tnode.$children.hide().empty();\n\n\t\tif (child_nodes) {\n\t\t\t$.each(child_nodes, (_i, data) => {\n\t\t\t\tthis.add_node(node, data);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.add_connector(node.id, data.id);\n\t\t\t\t}, 250);\n\t\t\t});\n\t\t}\n\n\t\tnode.$children.show();\n\t\t$(`path[data-parent=\"${node.id}\"]`).show();\n\t\tnode.expanded = true;\n\t}\n\n\tadd_node(node, data) {\n\t\treturn new this.Node({\n\t\t\tid: data.id,\n\t\t\tparent: $('<li class=\"child-node\"></li>').appendTo(node.$children),\n\t\t\tparent_id: node.id,\n\t\t\timage: data.image,\n\t\t\tname: data.name,\n\t\t\ttitle: data.title,\n\t\t\texpandable: data.expandable,\n\t\t\tconnections: data.connections,\n\t\t\tchildren: undefined\n\t\t});\n\t}\n\n\tadd_connector(parent_id, child_id) {\n\t\t// using pure javascript for better performance\n\t\tconst parent_node = document.getElementById(`${parent_id}`);\n\t\tconst child_node = document.getElementById(`${child_id}`);\n\n\t\tlet path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n\t\t// we need to connect right side of the parent to the left side of the child node\n\t\tconst pos_parent_right = {\n\t\t\tx: parent_node.offsetLeft + parent_node.offsetWidth,\n\t\t\ty: parent_node.offsetTop + parent_node.offsetHeight / 2\n\t\t};\n\t\tconst pos_child_left = {\n\t\t\tx: child_node.offsetLeft - 5,\n\t\t\ty: child_node.offsetTop + child_node.offsetHeight / 2\n\t\t};\n\n\t\tconst connector = this.get_connector(pos_parent_right, pos_child_left);\n\n\t\tpath.setAttribute('d', connector);\n\t\tthis.set_path_attributes(path, parent_id, child_id);\n\n\t\tdocument.getElementById('connectors').appendChild(path);\n\t}\n\n\tget_connector(pos_parent_right, pos_child_left) {\n\t\tif (pos_parent_right.y === pos_child_left.y) {\n\t\t\t// don't add arcs if it's a straight line\n\t\t\treturn \"M\" +\n\t\t\t(pos_parent_right.x) + \",\" + (pos_parent_right.y) + \" \" +\n\t\t\t\"L\"+\n\t\t\t(pos_child_left.x) + \",\" + (pos_child_left.y);\n\t\t} else {\n\t\t\tlet arc_1 = \"\";\n\t\t\tlet arc_2 = \"\";\n\t\t\tlet offset = 0;\n\n\t\t\tif (pos_parent_right.y > pos_child_left.y) {\n\t\t\t\t// if child is above parent on Y axis 1st arc is anticlocwise\n\t\t\t\t// second arc is clockwise\n\t\t\t\tarc_1 = \"a10,10 1 0 0 10,-10 \";\n\t\t\t\tarc_2 = \"a10,10 0 0 1 10,-10 \";\n\t\t\t\toffset = 10;\n\t\t\t} else {\n\t\t\t\t// if child is below parent on Y axis 1st arc is clockwise\n\t\t\t\t// second arc is anticlockwise\n\t\t\t\tarc_1 = \"a10,10 0 0 1 10,10 \";\n\t\t\t\tarc_2 = \"a10,10 1 0 0 10,10 \";\n\t\t\t\toffset = -10;\n\t\t\t}\n\n\t\t\treturn \"M\" + (pos_parent_right.x) + \",\" + (pos_parent_right.y) + \" \" +\n\t\t\t\t\"L\" +\n\t\t\t\t(pos_parent_right.x + 40) + \",\" + (pos_parent_right.y) + \" \" +\n\t\t\t\tarc_1 +\n\t\t\t\t\"L\" +\n\t\t\t\t(pos_parent_right.x + 50) + \",\" + (pos_child_left.y + offset) + \" \" +\n\t\t\t\tarc_2 +\n\t\t\t\t\"L\"+\n\t\t\t\t(pos_child_left.x) + \",\" + (pos_child_left.y);\n\t\t}\n\t}\n\n\tset_path_attributes(path, parent_id, child_id) {\n\t\tpath.setAttribute(\"data-parent\", parent_id);\n\t\tpath.setAttribute(\"data-child\", child_id);\n\t\tconst parent = $(`[id=\"${parent_id}\"]`);\n\n\t\tif (parent.hasClass('active')) {\n\t\t\tpath.setAttribute(\"class\", \"active-connector\");\n\t\t\tpath.setAttribute(\"marker-start\", \"url(#arrowstart-active)\");\n\t\t\tpath.setAttribute(\"marker-end\", \"url(#arrowhead-active)\");\n\t\t} else {\n\t\t\tpath.setAttribute(\"class\", \"collapsed-connector\");\n\t\t\tpath.setAttribute(\"marker-start\", \"url(#arrowstart-collapsed)\");\n\t\t\tpath.setAttribute(\"marker-end\", \"url(#arrowhead-collapsed)\");\n\t\t}\n\t}\n\n\tset_selected_node(node) {\n\t\t// remove active class from the current node\n\t\tif (this.selected_node)\n\t\t\tthis.selected_node.$link.removeClass('active');\n\n\t\t// add active class to the newly selected node\n\t\tthis.selected_node = node;\n\t\tnode.$link.addClass('active');\n\t}\n\n\tcollapse_previous_level_nodes(node) {\n\t\tlet node_parent = $(`[id=\"${node.parent_id}\"]`);\n\t\tlet previous_level_nodes = node_parent.parent().parent().children('li');\n\t\tlet node_card = undefined;\n\n\t\tprevious_level_nodes.each(function() {\n\t\t\tnode_card = $(this).find('.node-card');\n\n\t\t\tif (!node_card.hasClass('active-path')) {\n\t\t\t\tnode_card.addClass('collapsed');\n\t\t\t}\n\t\t});\n\t}\n\n\trefresh_connectors(node_parent) {\n\t\tif (!node_parent) return;\n\n\t\t$(`path[data-parent=\"${node_parent}\"]`).remove();\n\n\t\tfrappe.run_serially([\n\t\t\t() => this.get_child_nodes(node_parent),\n\t\t\t(child_nodes) => {\n\t\t\t\tif (child_nodes) {\n\t\t\t\t\t$.each(child_nodes, (_i, data) => {\n\t\t\t\t\t\tthis.add_connector(node_parent, data.id);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t]);\n\t}\n\n\tsetup_node_click_action(node) {\n\t\tlet me = this;\n\t\tlet node_element = $(`[id=\"${node.id}\"]`);\n\n\t\tnode_element.click(function() {\n\t\t\tconst is_sibling = me.selected_node.parent_id === node.parent_id;\n\n\t\t\tif (is_sibling) {\n\t\t\t\tme.collapse_node();\n\t\t\t} else if (node_element.is(':visible')\n\t\t\t\t&& (node_element.hasClass('collapsed') || node_element.hasClass('active-path'))) {\n\t\t\t\tme.remove_levels_after_node(node);\n\t\t\t\tme.remove_orphaned_connectors();\n\t\t\t}\n\n\t\t\tme.expand_node(node);\n\t\t});\n\t}\n\n\tsetup_edit_node_action(node) {\n\t\tlet node_element = $(`[id=\"${node.id}\"]`);\n\t\tlet me = this;\n\n\t\tnode_element.find('.btn-edit-node').click(function() {\n\t\t\tfrappe.set_route('Form', me.doctype, node.id);\n\t\t});\n\t}\n\n\tremove_levels_after_node(node) {\n\t\tlet level = $(`[id=\"${node.id}\"]`).parent().parent().parent().index();\n\n\t\tlevel = $('.hierarchy > li:eq('+ level + ')');\n\t\tlevel.nextAll('li').remove();\n\n\t\tlet nodes = level.find('.node-card');\n\t\tlet node_object = undefined;\n\n\t\t$.each(nodes, (_i, element) => {\n\t\t\tnode_object = this.nodes[element.id];\n\t\t\tnode_object.expanded = 0;\n\t\t\tnode_object.$children = undefined;\n\t\t});\n\n\t\tnodes.removeClass('collapsed active-path');\n\t}\n\n\tremove_orphaned_connectors() {\n\t\tlet paths = $('#connectors > path');\n\t\t$.each(paths, (_i, path) => {\n\t\t\tconst parent = $(path).data('parent');\n\t\t\tconst child = $(path).data('child');\n\n\t\t\tif ($(`[id=\"${parent}\"]`).length && $(`[id=\"${child}\"]`).length)\n\t\t\t\treturn;\n\n\t\t\t$(path).remove();\n\t\t});\n\t}\n};\n","erpnext.HierarchyChartMobile = class {\n\t/* Options:\n\t\t- doctype\n\t\t- wrapper: wrapper for the hierarchy view\n\t\t- method:\n\t\t\t- to get the data for each node\n\t\t\t- this method should return id, name, title, image, and connections for each node\n\t*/\n\tconstructor(doctype, wrapper, method) {\n\t\tthis.page = wrapper.page;\n\t\tthis.method = method;\n\t\tthis.doctype = doctype;\n\n\t\tthis.page.main.css({\n\t\t\t'min-height': '300px',\n\t\t\t'max-height': '600px',\n\t\t\t'overflow': 'auto',\n\t\t\t'position': 'relative'\n\t\t});\n\t\tthis.page.main.addClass('frappe-card');\n\n\t\tthis.nodes = {};\n\t\tthis.setup_node_class();\n\t}\n\n\tsetup_node_class() {\n\t\tlet me = this;\n\t\tthis.Node = class {\n\t\t\tconstructor({\n\t\t\t\tid, parent, parent_id, image, name, title, expandable, connections, is_root // eslint-disable-line\n\t\t\t}) {\n\t\t\t\t// to setup values passed via constructor\n\t\t\t\t$.extend(this, arguments[0]);\n\n\t\t\t\tthis.expanded = 0;\n\n\t\t\t\tme.nodes[this.id] = this;\n\t\t\t\tme.make_node_element(this);\n\t\t\t\tme.setup_node_click_action(this);\n\t\t\t\tme.setup_edit_node_action(this);\n\t\t\t}\n\t\t};\n\t}\n\n\tmake_node_element(node) {\n\t\tlet node_card = frappe.render_template('node_card', {\n\t\t\tid: node.id,\n\t\t\tname: node.name,\n\t\t\ttitle: node.title,\n\t\t\timage: node.image,\n\t\t\tparent: node.parent_id,\n\t\t\tconnections: node.connections,\n\t\t\tis_mobile: true\n\t\t});\n\n\t\tnode.parent.append(node_card);\n\t\tnode.$link = $(`[id=\"${node.id}\"]`);\n\t\tnode.$link.addClass('mobile-node');\n\t}\n\n\tshow() {\n\t\tlet me = this;\n\t\tif ($(`[data-fieldname=\"company\"]`).length) return;\n\n\t\tlet company = this.page.add_field({\n\t\t\tfieldtype: 'Link',\n\t\t\toptions: 'Company',\n\t\t\tfieldname: 'company',\n\t\t\tplaceholder: __('Select Company'),\n\t\t\tdefault: frappe.defaults.get_default('company'),\n\t\t\tonly_select: true,\n\t\t\treqd: 1,\n\t\t\tchange: () => {\n\t\t\t\tme.company = undefined;\n\n\t\t\t\tif (company.get_value() && me.company != company.get_value()) {\n\t\t\t\t\tme.company = company.get_value();\n\n\t\t\t\t\t// svg for connectors\n\t\t\t\t\tme.make_svg_markers();\n\n\t\t\t\t\tif (me.$sibling_group)\n\t\t\t\t\t\tme.$sibling_group.remove();\n\n\t\t\t\t\t// setup sibling group wrapper\n\t\t\t\t\tme.$sibling_group = $(`<div class=\"sibling-group mt-4 mb-4\"></div>`);\n\t\t\t\t\tme.page.main.append(me.$sibling_group);\n\n\t\t\t\t\tme.setup_hierarchy();\n\t\t\t\t\tme.render_root_nodes();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tcompany.refresh();\n\t\t$(`[data-fieldname=\"company\"]`).trigger('change');\n\t}\n\n\tmake_svg_markers() {\n\t\t$('#arrows').remove();\n\n\t\tthis.page.main.prepend(`\n\t\t\t<svg id=\"arrows\" width=\"100%\" height=\"100%\">\n\t\t\t\t<defs>\n\t\t\t\t\t<marker id=\"arrowhead-active\" viewBox=\"0 0 10 10\" refX=\"3\" refY=\"5\" markerWidth=\"6\" markerHeight=\"6\" orient=\"auto\" fill=\"var(--blue-500)\">\n\t\t\t\t\t\t<path d=\"M 0 0 L 10 5 L 0 10 z\"></path>\n\t\t\t\t\t</marker>\n\t\t\t\t\t<marker id=\"arrowhead-collapsed\" viewBox=\"0 0 10 10\" refX=\"3\" refY=\"5\" markerWidth=\"6\" markerHeight=\"6\" orient=\"auto\" fill=\"var(--blue-300)\">\n\t\t\t\t\t\t<path d=\"M 0 0 L 10 5 L 0 10 z\"></path>\n\t\t\t\t\t</marker>\n\n\t\t\t\t\t<marker id=\"arrowstart-active\" viewBox=\"0 0 10 10\" refX=\"3\" refY=\"5\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\" fill=\"var(--blue-500)\">\n\t\t\t\t\t\t<circle cx=\"4\" cy=\"4\" r=\"3.5\" fill=\"white\" stroke=\"var(--blue-500)\"/>\n\t\t\t\t\t</marker>\n\t\t\t\t\t<marker id=\"arrowstart-collapsed\" viewBox=\"0 0 10 10\" refX=\"3\" refY=\"5\" markerWidth=\"8\" markerHeight=\"8\" orient=\"auto\" fill=\"var(--blue-300)\">\n\t\t\t\t\t\t<circle cx=\"4\" cy=\"4\" r=\"3.5\" fill=\"white\" stroke=\"var(--blue-300)\"/>\n\t\t\t\t\t</marker>\n\t\t\t\t</defs>\n\t\t\t\t<g id=\"connectors\" fill=\"none\">\n\t\t\t\t</g>\n\t\t\t</svg>`);\n\t}\n\n\tsetup_hierarchy() {\n\t\t$(`#connectors`).empty();\n\t\tif (this.$hierarchy)\n\t\t\tthis.$hierarchy.remove();\n\n\t\tif (this.$sibling_group)\n\t\t\tthis.$sibling_group.empty();\n\n\t\tthis.$hierarchy = $(\n\t\t\t`<ul class=\"hierarchy-mobile\">\n\t\t\t\t<li class=\"root-level level\"></li>\n\t\t\t</ul>`);\n\n\t\tthis.page.main.append(this.$hierarchy);\n\t}\n\n\trender_root_nodes() {\n\t\tlet me = this;\n\n\t\tfrappe.call({\n\t\t\tmethod: me.method,\n\t\t\targs: {\n\t\t\t\tcompany: me.company\n\t\t\t},\n\t\t}).then(r => {\n\t\t\tif (r.message.length) {\n\t\t\t\tlet root_level = me.$hierarchy.find('.root-level');\n\t\t\t\troot_level.empty();\n\n\t\t\t\t$.each(r.message, (_i, data) => {\n\t\t\t\t\treturn new me.Node({\n\t\t\t\t\t\tid: data.id,\n\t\t\t\t\t\tparent: root_level,\n\t\t\t\t\t\tparent_id: undefined,\n\t\t\t\t\t\timage: data.image,\n\t\t\t\t\t\tname: data.name,\n\t\t\t\t\t\ttitle: data.title,\n\t\t\t\t\t\texpandable: true,\n\t\t\t\t\t\tconnections: data.connections,\n\t\t\t\t\t\tis_root: true\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\texpand_node(node) {\n\t\tconst is_same_node = (this.selected_node && this.selected_node.id === node.id);\n\t\tthis.set_selected_node(node);\n\t\tthis.show_active_path(node);\n\n\t\tif (this.$sibling_group) {\n\t\t\tconst sibling_parent = this.$sibling_group.find('.node-group').attr('data-parent');\n\t\t\tif (node.parent_id !== undefined && node.parent_id != sibling_parent)\n\t\t\t\tthis.$sibling_group.empty();\n\t\t}\n\n\t\tif (!is_same_node) {\n\t\t\t// since the previous/parent node collapses, all connections to that node need to be rebuilt\n\t\t\t// rebuild outgoing connections of parent\n\t\t\tthis.refresh_connectors(node.parent_id, node.id);\n\n\t\t\t// rebuild incoming connections of parent\n\t\t\tlet grandparent = $(`[id=\"${node.parent_id}\"]`).attr('data-parent');\n\t\t\tthis.refresh_connectors(grandparent, node.parent_id);\n\t\t}\n\n\t\tif (node.expandable && !node.expanded) {\n\t\t\treturn this.load_children(node);\n\t\t}\n\t}\n\n\tcollapse_node() {\n\t\tlet node = this.selected_node;\n\t\tif (node.expandable && node.$children) {\n\t\t\tnode.$children.hide();\n\t\t\tnode.expanded = 0;\n\n\t\t\t// add a collapsed level to show the collapsed parent\n\t\t\t// and a button beside it to move to that level\n\t\t\tlet node_parent = node.$link.parent();\n\t\t\tnode_parent.prepend(\n\t\t\t\t`<div class=\"collapsed-level d-flex flex-row\"></div>`\n\t\t\t);\n\n\t\t\tnode_parent\n\t\t\t\t.find('.collapsed-level')\n\t\t\t\t.append(node.$link);\n\n\t\t\tfrappe.run_serially([\n\t\t\t\t() => this.get_child_nodes(node.parent_id, node.id),\n\t\t\t\t(child_nodes) => this.get_node_group(child_nodes, node.parent_id),\n\t\t\t\t(node_group) => node_parent.find('.collapsed-level').append(node_group),\n\t\t\t\t() => this.setup_node_group_action()\n\t\t\t]);\n\t\t}\n\t}\n\n\tshow_active_path(node) {\n\t\t// mark node parent on active path\n\t\t$(`[id=\"${node.parent_id}\"]`).addClass('active-path');\n\t}\n\n\tload_children(node) {\n\t\tfrappe.run_serially([\n\t\t\t() => this.get_child_nodes(node.id),\n\t\t\t(child_nodes) => this.render_child_nodes(node, child_nodes)\n\t\t]);\n\t}\n\n\tget_child_nodes(node_id, exclude_node=null) {\n\t\tlet me = this;\n\t\treturn new Promise(resolve => {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: me.method,\n\t\t\t\targs: {\n\t\t\t\t\tparent: node_id,\n\t\t\t\t\tcompany: me.company,\n\t\t\t\t\texclude_node: exclude_node\n\t\t\t\t}\n\t\t\t}).then(r => resolve(r.message));\n\t\t});\n\t}\n\n\trender_child_nodes(node, child_nodes) {\n\t\tif (!node.$children) {\n\t\t\tnode.$children = $('<ul class=\"node-children\"></ul>')\n\t\t\t\t.hide()\n\t\t\t\t.appendTo(node.$link.parent());\n\n\t\t\tnode.$children.empty();\n\n\t\t\tif (child_nodes) {\n\t\t\t\t$.each(child_nodes, (_i, data) => {\n\t\t\t\t\tthis.add_node(node, data);\n\t\t\t\t\t$(`[id=\"${data.id}\"]`).addClass('active-child');\n\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.add_connector(node.id, data.id);\n\t\t\t\t\t}, 250);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tnode.$children.show();\n\t\tnode.expanded = 1;\n\t}\n\n\tadd_node(node, data) {\n\t\tvar $li = $('<li class=\"child-node\"></li>');\n\n\t\treturn new this.Node({\n\t\t\tid: data.id,\n\t\t\tparent: $li.appendTo(node.$children),\n\t\t\tparent_id: node.id,\n\t\t\timage: data.image,\n\t\t\tname: data.name,\n\t\t\ttitle: data.title,\n\t\t\texpandable: data.expandable,\n\t\t\tconnections: data.connections,\n\t\t\tchildren: undefined\n\t\t});\n\t}\n\n\tadd_connector(parent_id, child_id) {\n\t\tconst parent_node = document.getElementById(`${parent_id}`);\n\t\tconst child_node = document.getElementById(`${child_id}`);\n\n\t\tconst path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n\t\tlet connector = undefined;\n\n\t\tif ($(`[id=\"${parent_id}\"]`).hasClass('active')) {\n\t\t\tconnector = this.get_connector_for_active_node(parent_node, child_node);\n\t\t} else if ($(`[id=\"${parent_id}\"]`).hasClass('active-path')) {\n\t\t\tconnector = this.get_connector_for_collapsed_node(parent_node, child_node);\n\t\t}\n\n\t\tpath.setAttribute('d', connector);\n\t\tthis.set_path_attributes(path, parent_id, child_id);\n\n\t\tdocument.getElementById('connectors').appendChild(path);\n\t}\n\n\tget_connector_for_active_node(parent_node, child_node) {\n\t\t// we need to connect the bottom left of the parent to the left side of the child node\n\t\tlet pos_parent_bottom = {\n\t\t\tx: parent_node.offsetLeft + 20,\n\t\t\ty: parent_node.offsetTop + parent_node.offsetHeight\n\t\t};\n\t\tlet pos_child_left = {\n\t\t\tx: child_node.offsetLeft - 5,\n\t\t\ty: child_node.offsetTop + child_node.offsetHeight / 2\n\t\t};\n\n\t\tlet connector =\n\t\t\t\"M\" +\n\t\t\t(pos_parent_bottom.x) + \",\" + (pos_parent_bottom.y) + \" \" +\n\t\t\t\"L\" +\n\t\t\t(pos_parent_bottom.x) + \",\" + (pos_child_left.y - 10) + \" \" +\n\t\t\t\"a10,10 1 0 0 10,10 \" +\n\t\t\t\"L\" +\n\t\t\t(pos_child_left.x) + \",\" + (pos_child_left.y);\n\n\t\treturn connector;\n\t}\n\n\tget_connector_for_collapsed_node(parent_node, child_node) {\n\t\t// we need to connect the bottom left of the parent to the top left of the child node\n\t\tlet pos_parent_bottom = {\n\t\t\tx: parent_node.offsetLeft + 20,\n\t\t\ty: parent_node.offsetTop + parent_node.offsetHeight\n\t\t};\n\t\tlet pos_child_top = {\n\t\t\tx: child_node.offsetLeft + 20,\n\t\t\ty: child_node.offsetTop\n\t\t};\n\n\t\tlet connector =\n\t\t\t\"M\" +\n\t\t\t(pos_parent_bottom.x) + \",\" + (pos_parent_bottom.y) + \" \" +\n\t\t\t\"L\" +\n\t\t\t(pos_child_top.x) + \",\" + (pos_child_top.y);\n\n\t\treturn connector;\n\t}\n\n\tset_path_attributes(path, parent_id, child_id) {\n\t\tpath.setAttribute(\"data-parent\", parent_id);\n\t\tpath.setAttribute(\"data-child\", child_id);\n\t\tconst parent = $(`[id=\"${parent_id}\"]`);\n\n\t\tif (parent.hasClass('active')) {\n\t\t\tpath.setAttribute(\"class\", \"active-connector\");\n\t\t\tpath.setAttribute(\"marker-start\", \"url(#arrowstart-active)\");\n\t\t\tpath.setAttribute(\"marker-end\", \"url(#arrowhead-active)\");\n\t\t} else if (parent.hasClass('active-path')) {\n\t\t\tpath.setAttribute(\"class\", \"collapsed-connector\");\n\t\t}\n\t}\n\n\tset_selected_node(node) {\n\t\t// remove .active class from the current node\n\t\tif (this.selected_node)\n\t\t\tthis.selected_node.$link.removeClass('active');\n\n\t\t// add active class to the newly selected node\n\t\tthis.selected_node = node;\n\t\tnode.$link.addClass('active');\n\t}\n\n\tsetup_node_click_action(node) {\n\t\tlet me = this;\n\t\tlet node_element = $(`[id=\"${node.id}\"]`);\n\n\t\tnode_element.click(function() {\n\t\t\tlet el = undefined;\n\n\t\t\tif (node.is_root) {\n\t\t\t\tel = $(this).detach();\n\t\t\t\tme.$hierarchy.empty();\n\t\t\t\t$(`#connectors`).empty();\n\t\t\t\tme.add_node_to_hierarchy(el, node);\n\t\t\t} else if (node_element.is(':visible') && node_element.hasClass('active-path')) {\n\t\t\t\tme.remove_levels_after_node(node);\n\t\t\t\tme.remove_orphaned_connectors();\n\t\t\t} else {\n\t\t\t\tel = $(this).detach();\n\t\t\t\tme.add_node_to_hierarchy(el, node);\n\t\t\t\tme.collapse_node();\n\t\t\t}\n\n\t\t\tme.expand_node(node);\n\t\t});\n\t}\n\n\tsetup_edit_node_action(node) {\n\t\tlet node_element = $(`[id=\"${node.id}\"]`);\n\t\tlet me = this;\n\n\t\tnode_element.find('.btn-edit-node').click(function() {\n\t\t\tfrappe.set_route('Form', me.doctype, node.id);\n\t\t});\n\t}\n\n\tsetup_node_group_action() {\n\t\tlet me = this;\n\n\t\t$('.node-group').on('click', function() {\n\t\t\tlet parent = $(this).attr('data-parent');\n\t\t\tif (parent === 'undefined') {\n\t\t\t\tme.setup_hierarchy();\n\t\t\t\tme.render_root_nodes();\n\t\t\t} else {\n\t\t\t\tme.expand_sibling_group_node(parent);\n\t\t\t}\n\t\t});\n\t}\n\n\tadd_node_to_hierarchy(node_element, node) {\n\t\tthis.$hierarchy.append(`<li class=\"level\"></li>`);\n\t\tnode_element.removeClass('active-child active-path');\n\t\tthis.$hierarchy.find('.level:last').append(node_element);\n\n\t\tlet node_object = this.nodes[node.id];\n\t\tnode_object.expanded = 0;\n\t\tnode_object.$children = undefined;\n\t\tthis.nodes[node.id] = node_object;\n\t}\n\n\tget_node_group(nodes, parent, collapsed=true) {\n\t\tlet limit = 2;\n\t\tconst display_nodes = nodes.slice(0, limit);\n\t\tconst extra_nodes = nodes.slice(limit);\n\n\t\tlet html = display_nodes.map(node =>\n\t\t\tthis.get_avatar(node)\n\t\t).join('');\n\n\t\tif (extra_nodes.length === 1) {\n\t\t\tlet node = extra_nodes[0];\n\t\t\thtml += this.get_avatar(node);\n\t\t} else if (extra_nodes.length > 1) {\n\t\t\thtml = `\n\t\t\t\t${html}\n\t\t\t\t<span class=\"avatar avatar-small\">\n\t\t\t\t\t<div class=\"avatar-frame standard-image avatar-extra-count\"\n\t\t\t\t\t\ttitle=\"${extra_nodes.map(node => node.name).join(', ')}\">\n\t\t\t\t\t\t+${extra_nodes.length}\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t}\n\n\t\tif (html) {\n\t\t\tconst $node_group =\n\t\t\t\t$(`<div class=\"node-group card cursor-pointer\" data-parent=${parent}>\n\t\t\t\t\t<div class=\"avatar-group right overlap\">\n\t\t\t\t\t\t${html}\n\t\t\t\t\t</div>\n\t\t\t\t</div>`);\n\n\t\t\tif (collapsed)\n\t\t\t\t$node_group.addClass('collapsed');\n\n\t\t\treturn $node_group;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tget_avatar(node) {\n\t\treturn `<span class=\"avatar avatar-small\" title=\"${node.name}\">\n\t\t\t<span class=\"avatar-frame\" src=${node.image} style=\"background-image: url(${node.image})\"></span>\n\t\t</span>`;\n\t}\n\n\texpand_sibling_group_node(parent) {\n\t\tlet node_object = this.nodes[parent];\n\t\tlet node = node_object.$link;\n\n\t\tnode.removeClass('active-child active-path');\n\t\tnode_object.expanded = 0;\n\t\tnode_object.$children = undefined;\n\t\tthis.nodes[node.id] = node_object;\n\n\t\t// show parent's siblings and expand parent node\n\t\tfrappe.run_serially([\n\t\t\t() => this.get_child_nodes(node_object.parent_id, node_object.id),\n\t\t\t(child_nodes) => this.get_node_group(child_nodes, node_object.parent_id, false),\n\t\t\t(node_group) => {\n\t\t\t\tif (node_group)\n\t\t\t\t\tthis.$sibling_group.empty().append(node_group);\n\t\t\t},\n\t\t\t() => this.setup_node_group_action(),\n\t\t\t() => this.reattach_and_expand_node(node, node_object)\n\t\t]);\n\t}\n\n\treattach_and_expand_node(node, node_object) {\n\t\tvar el = node.detach();\n\n\t\tthis.$hierarchy.empty().append(`\n\t\t\t<li class=\"level\"></li>\n\t\t`);\n\t\tthis.$hierarchy.find('.level').append(el);\n\t\t$(`#connectors`).empty();\n\t\tthis.expand_node(node_object);\n\t}\n\n\tremove_levels_after_node(node) {\n\t\tlet level = $(`[id=\"${node.id}\"]`).parent().parent().index();\n\n\t\tlevel = $('.hierarchy-mobile > li:eq('+ level + ')');\n\t\tlevel.nextAll('li').remove();\n\n\t\tlet node_object = this.nodes[node.id];\n\t\tlet current_node = level.find(`[id=\"${node.id}\"]`).detach();\n\n\t\tcurrent_node.removeClass('active-child active-path');\n\n\t\tnode_object.expanded = 0;\n\t\tnode_object.$children = undefined;\n\n\t\tlevel.empty().append(current_node);\n\t}\n\n\tremove_orphaned_connectors() {\n\t\tlet paths = $('#connectors > path');\n\t\t$.each(paths, (_i, path) => {\n\t\t\tconst parent = $(path).data('parent');\n\t\t\tconst child = $(path).data('child');\n\n\t\t\tif ($(`[id=\"${parent}\"]`).length && $(`[id=\"${child}\"]`).length)\n\t\t\t\treturn;\n\n\t\t\t$(path).remove();\n\t\t});\n\t}\n\n\trefresh_connectors(node_parent, node_id) {\n\t\tif (!node_parent) return;\n\n\t\t$(`path[data-parent=\"${node_parent}\"]`).remove();\n\t\tthis.add_connector(node_parent, node_id);\n\t}\n};\n"],"names":["let","const","this"],"mappings":"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"}